@model Store.Models.ViewModels.CheckoutViewModel

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-6 col-md-8">

            <div class="card shadow border-0 rounded-4 overflow-hidden">
                <!-- Header -->
                <div class="bg-gradient-theme text-white text-center py-4 position-relative">
                    <div class="position-absolute top-0 start-50 translate-middle bg-white rounded-circle shadow-sm p-3 mt-3">
                        <i class="bi bi-bag-heart-fill text-theme fs-3"></i>
                    </div>
                    <h3 class="mt-5 mb-2 fw-bold text-uppercase">Xác nhận thanh toán</h3>
                    <p class="mb-0 small opacity-75">Vui lòng kiểm tra thông tin trước khi thanh toán</p>
                </div>

                <!-- Body -->
                <div class="card-body p-4 bg-light">
                    <form asp-action="Confirm" method="post" class="needs-validation" novalidate id="checkoutForm">
                        <!-- Họ tên -->
                        <div class="mb-4">
                            <label asp-for="User.UserName" class="form-label fw-semibold text-uppercase small text-theme">Họ và tên</label>
                            <div class="input-group input-group-lg">
                                <span class="input-group-text bg-white"><i class="bi bi-person-fill text-theme"></i></span>
                                <input asp-for="User.UserName" class="form-control border-start-0" placeholder="Nhập tên của bạn" required />
                            </div>
                            <span asp-validation-for="User.UserName" class="text-danger small"></span>
                        </div>

                        <!-- Email -->
                        <div class="mb-4">
                            <label asp-for="User.UserEmail" class="form-label fw-semibold text-uppercase small text-theme">Email</label>
                            <div class="input-group input-group-lg">
                                <span class="input-group-text bg-white"><i class="bi bi-envelope-fill text-theme"></i></span>
                                <input asp-for="User.UserEmail" class="form-control border-start-0" type="email" placeholder="example@gmail.com" required />
                            </div>
                            <span asp-validation-for="User.UserEmail" class="text-danger small"></span>
                        </div>

                        <!-- Tổng thanh toán -->
                        <div class="alert alert-theme text-center fs-5 fw-semibold rounded-3 shadow-sm mt-4" role="alert">
                            <i class="bi bi-receipt me-2"></i>
                            Tổng thanh toán (đã gồm phí ship):
                            <span class="text-theme-dark ms-2 fs-4">$@Model.TotalAmount.ToString("n0")</span>
                        </div>

                        <input type="hidden" asp-for="TotalAmount" />

                        <!-- Nút xác nhận -->
                        <button type="submit" id="confirmBtn" class="btn btn-theme w-100 py-3 fw-semibold text-uppercase shadow-sm mt-3">
                            <i class="bi bi-credit-card me-2"></i> Xác nhận thanh toán
                        </button>
                    </form>
                </div>

                <!-- Footer -->
                <div class="card-footer text-center bg-white py-3 small text-muted">
                    Cảm ơn bạn đã tin tưởng mua hàng tại <strong class="text-theme">ZMobile</strong> 💖
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    :root {
        --theme-color: #D19C97;
        --theme-color-dark: #b67872;
        --theme-color-light: #f2d3cf;
    }

    .text-theme {
        color: var(--theme-color) !important;
    }

    .text-theme-dark {
        color: var(--theme-color-dark) !important;
    }

    .bg-gradient-theme {
        background: linear-gradient(135deg, var(--theme-color), var(--theme-color-dark));
    }

    .alert-theme {
        background-color: var(--theme-color-light);
        color: var(--theme-color-dark);
        border: none;
    }

    .btn-theme {
        background: linear-gradient(90deg, var(--theme-color), var(--theme-color-dark));
        color: #fff;
        border: none;
        transition: all 0.3s ease;
    }

        .btn-theme:hover {
            background: linear-gradient(90deg, var(--theme-color-dark), var(--theme-color));
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            color: #fff;
        }

    .card {
        transition: all 0.3s ease;
    }

        .card:hover {
            transform: translateY(-5px);
        }

    input:focus, .form-control:focus {
        box-shadow: none;
        border-color: var(--theme-color);
    }

    .spinner-border {
        width: 1.3rem;
        height: 1.3rem;
        color: #fff;
    }
</style>

<script>
    (function () {
        'use strict';

        const form = document.getElementById('checkoutForm');

        form.addEventListener('submit', function (event) {
            // Nếu form không hợp lệ
            if (!form.checkValidity()) {
                event.preventDefault();  // Ngăn submit
                event.stopPropagation(); // Ngăn bubble lên DOM
            } else {
                // Nếu hợp lệ, show spinner
                const btn = document.getElementById('confirmBtn');
                btn.disabled = true;
                btn.innerHTML = `
                    <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
                    Đang xử lý...
                `;
            }

            form.classList.add('was-validated'); // hiển thị lỗi
        }, false);
    })();

</script>
